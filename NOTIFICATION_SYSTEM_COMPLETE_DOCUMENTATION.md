# ğŸ”” Ø³ÛŒØ³ØªÙ… Ú©Ø§Ù…Ù„ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† - Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø¬Ø§Ù…Ø¹

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

1. [Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ø³ÛŒØ³ØªÙ…](#Ù†Ù…Ø§ÛŒ-Ú©Ù„ÛŒ-Ø³ÛŒØ³ØªÙ…)
2. [Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡](#Ù…Ø¹Ù…Ø§Ø±ÛŒ-Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡)
3. [Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ Ú©Ø§Ø±](#Ø¬Ø±ÛŒØ§Ù†-Ú©Ø§Ù…Ù„-Ú©Ø§Ø±)
4. [ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ](#ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ-Ú©Ù„ÛŒØ¯ÛŒ)
5. [Ø§Ù†ÙˆØ§Ø¹ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†](#Ø§Ù†ÙˆØ§Ø¹-Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†)
6. [Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ§Ù…](#Ø³Ø§Ø®ØªØ§Ø±-Ù¾ÛŒØ§Ù…)
7. [Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ Ùˆ ØµØ¯Ø§Ù‡Ø§](#Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§-Ùˆ-ØµØ¯Ø§Ù‡Ø§)
8. [ØªØ³Øª Ùˆ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ](#ØªØ³Øª-Ùˆ-Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ)

---

## ğŸ¯ Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ Ø³ÛŒØ³ØªÙ…

Ø³ÛŒØ³ØªÙ… Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø§ÛŒÙ† Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø¨Ø§ **Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡** Ùˆ **Firebase Cloud Messaging** Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ú©Ù‡ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø±Ø§ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯:

### âœ¨ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:
- **ğŸ”¥ Firebase Cloud Messaging (FCM)** Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø§Ø² Ø³Ø±ÙˆØ±
- **ğŸ“± Native Android/iOS Services** Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ background
- **ğŸµ ØµØ¯Ø§Ù‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ** Ø¨Ø±Ø§ÛŒ Ø§Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„Ù Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
- **ğŸ”Š Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡** Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ØªØ±
- **ğŸŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Ø²Ø¨Ø§Ù†** (ÙØ§Ø±Ø³ÛŒØŒ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒØŒ Ø¹Ø±Ø¨ÛŒØŒ Ú†ÛŒÙ†ÛŒØŒ ØªØ±Ú©ÛŒØŒ Ø§Ø³Ù¾Ø§Ù†ÛŒØ§ÛŒÛŒ)
- **ğŸ›¡ï¸ Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø¬ÙˆØ²Ù‡Ø§** Ùˆ Ø§Ù…Ù†ÛŒØª
- **ğŸ“Š Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø®ÙˆØ¯Ú©Ø§Ø±** ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§

---

## ğŸ—ï¸ Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡

```
ğŸ“Š Backend Server (Django/Node.js)
    â†“ (Firebase Admin SDK)
â˜ï¸ Firebase Cloud Messaging (FCM)
    â†“ (Push Notification)
ğŸ“± Device (iOS/Android)
    â†“
ğŸ”¥ Native Layer (Kotlin/Swift)
    â†“ (Method Channel)
ğŸ“± Flutter Layer (Dart)
    â†“
ğŸ”” Local Notifications
    â†“
ğŸ‘¤ User Interface
```

### **Ù„Ø§ÛŒÙ‡ Û±: Backend Server**
- **Django API** Ø¨Ø§ Firebase Admin SDK
- **URL:** `https://coinceeper.com/api/`
- **Endpoint:** `/api/notifications/register-device`
- **Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù…** Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± JSON Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯

### **Ù„Ø§ÛŒÙ‡ Û²: Firebase Cloud Messaging**
- **Project:** `coinceeper-f2eaf`
- **API Key:** `AIzaSyBnmgQ6SVmxoAXUq4x5HvfA0bppDD_HO3Y`
- **ØªØ­ÙˆÛŒÙ„ Ù¾ÛŒØ§Ù…** Ø¨Ù‡ Ø¯Ø³ØªÚ¯Ø§Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡Ø¯Ù

### **Ù„Ø§ÛŒÙ‡ Û³: Native Layer**
- **Android:** `MyFirebaseMessagingService.kt`
- **iOS:** `AppDelegate.swift` + notification handling
- **Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ background/terminated**

### **Ù„Ø§ÛŒÙ‡ Û´: Flutter Layer**
- **Service:** `FirebaseMessagingService.dart`
- **Helper:** `NotificationHelper.dart`
- **Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ foreground**

### **Ù„Ø§ÛŒÙ‡ Ûµ: UI Layer**
- **Settings:** `NotificationManagementScreen.dart`
- **Provider:** `AppProvider.dart`
- **Ù†Ù…Ø§ÛŒØ´ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª** ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ø§Ø±Ø¨Ø±

---

## ğŸ”„ Ø¬Ø±ÛŒØ§Ù† Ú©Ø§Ù…Ù„ Ú©Ø§Ø±

### **1ï¸âƒ£ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ (App Startup)**

```dart
// main.dart
void main() async {
  // Initialize Firebase
  await Firebase.initializeApp(options: DefaultFirebaseOptions.currentPlatform);
  
  // Initialize services in parallel
  await Future.wait([
    NotificationHelper.initialize(),
    FirebaseMessagingService().initialize(),
  ]);
}
```

**Ø§ØªÙØ§Ù‚Ø§Øª:**
- âœ… Firebase Core initialize Ù…ÛŒâ€ŒØ´ÙˆØ¯
- âœ… FCM token Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
- âœ… Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- âœ… Ù…Ø¬ÙˆØ²Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

### **2ï¸âƒ£ Ø«Ø¨Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ (Device Registration)**

```dart
// FirebaseMessagingService.dart
Future<void> sendTokenToBackend() async {
  final success = await apiService.registerFCMToken(userId, _token);
}
```

**Ø¯Ø±Ø®ÙˆØ§Ø³Øª HTTP:**
```json
POST /api/notifications/register-device
{
  "UserID": "c1bf9df0-8263-41f1-844f-2e587f9b4050",
  "WalletID": "wallet-id-123",
  "DeviceToken": "fcm-token-here",
  "DeviceName": "Samsung Galaxy S21",
  "DeviceType": "android"
}
```

### **3ï¸âƒ£ Ø§Ø±Ø³Ø§Ù„ Ø§Ø² Ø³Ø±ÙˆØ± (Server Push)**

**Backend Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:**
```json
{
  "to": "USER_FCM_TOKEN",
  "notification": {
    "title": "ğŸ’° Received: 0.001 BTC",
    "body": "From 1A1zP1...eP2sh"
  },
  "data": {
    "type": "receive",
    "transaction_id": "tx_123456789",
    "amount": "0.001",
    "currency": "BTC",
    "direction": "inbound",
    "from_address": "1A1zP1eP2sh...",
    "to_address": "bc1qxy2k...",
    "wallet_id": "wallet-id-123"
  },
  "android": {
    "notification": {
      "channel_id": "receive_channel",
      "sound": "receive_sound"
    }
  }
}
```

### **4ï¸âƒ£ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø± Ø¯Ø³ØªÚ¯Ø§Ù‡ (Device Reception)**

#### **ğŸ¤– Android (Background/Terminated):**
```kotlin
// MyFirebaseMessagingService.kt
override fun onMessageReceived(remoteMessage: RemoteMessage) {
    val type = remoteMessage.data["type"] ?: "general"
    val channelId = when (type) {
        "receive" -> RECEIVE_CHANNEL_ID
        "send" -> SEND_CHANNEL_ID
        else -> DEFAULT_CHANNEL_ID
    }
    sendNotification(title, body, channelId)
}
```

#### **ğŸ“± Flutter (Foreground):**
```dart
// FirebaseMessagingService.dart
Future<void> _handleForegroundMessage(RemoteMessage message) async {
    await _showLocalNotification(message);
}
```

### **5ï¸âƒ£ Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† (Display)**

**Ø¨Ø§ Ú©Ø§Ù†Ø§Ù„ Ù…Ù†Ø§Ø³Ø¨:**
- ğŸµ **ØµØ¯Ø§ÛŒ Ù…Ø®ØµÙˆØµ** (receive_sound.ogg)
- ğŸ”´ **Ø§ÙˆÙ„ÙˆÛŒØª Ø¨Ø§Ù„Ø§** (High Priority)
- ğŸŒŸ **Ø¢ÛŒÚ©ÙˆÙ† Ù…Ø®ØµÙˆØµ** (ic_launcher)
- ğŸ¨ **Ø±Ù†Ú¯ Ù…Ù†Ø§Ø³Ø¨** (ØªØ¨Ø¹ÛŒ Ø§Ø² Ù†ÙˆØ¹)

### **6ï¸âƒ£ ØªØ¹Ø§Ù…Ù„ Ú©Ø§Ø±Ø¨Ø± (User Interaction)**

```dart
// Navigation based on notification type
switch (type?.toLowerCase()) {
  case 'receive':
  case 'send':
    // Navigate to transaction details
    break;
  case 'price_alert':
    // Navigate to market screen
    break;
  case 'security':
    // Navigate to security settings
    break;
}
```

---

## ğŸ“ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ

### **ğŸ”¥ Firebase & Core Services**

#### `lib/services/firebase_messaging_service.dart`
```dart
class FirebaseMessagingService {
  // FCM token management
  // Message handlers (foreground, background, terminated)
  // Local notification display
  // Native Android sync via MethodChannel
}
```

#### `android/app/src/main/kotlin/.../MyFirebaseMessagingService.kt`
```kotlin
class MyFirebaseMessagingService : FirebaseMessagingService() {
  // Background message processing
  // Notification channel management  
  // Custom sound handling
  // Intent creation for navigation
}
```

### **ğŸ”” Notification Management**

#### `lib/services/notification_helper.dart`
```dart
class NotificationHelper {
  // Channel creation and management
  // Show different notification types
  // Permission handling
  // Sound and priority settings
}
```

#### `lib/screens/notification_management_screen.dart`
```dart
class NotificationManagementScreen {
  // User notification preferences
  // Toggle push notifications
  // Toggle specific notification types
}
```

### **ğŸ—‚ï¸ Data Models**

#### `lib/services/transaction_notification_receiver.dart`
```dart
class TransactionNotificationReceiver {
  // Stream-based transaction notifications
  // Remove pending transactions
  // Handle confirmed/failed transactions
}
```

#### `lib/providers/history_provider.dart`
```dart
class HistoryProvider {
  // Manage pending transactions
  // Sync with server transactions
  // Remove confirmed transactions
}
```

### **âš™ï¸ Configuration Files**

#### `android/app/google-services.json`
```json
{
  "project_info": {
    "project_number": "1048276147027",
    "project_id": "coinceeper-f2eaf"
  }
}
```

#### `ios/Runner/GoogleService-Info.plist`
```xml
<key>GOOGLE_APP_ID</key>
<string>1:1048276147027:ios:8a9b0c1d2e3f4567</string>
```

#### `lib/firebase_options.dart`
```dart
static const FirebaseOptions android = FirebaseOptions(
  apiKey: 'AIzaSyBnmgQ6SVmxoAXUq4x5HvfA0bppDD_HO3Y',
  appId: '1:1048276147027:android:9c8b7a6d5e4f3241',
  messagingSenderId: '1048276147027',
  projectId: 'coinceeper-f2eaf',
);
```

---

## ğŸ¯ Ø§Ù†ÙˆØ§Ø¹ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†

### **1ï¸âƒ£ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ**

#### **ğŸ’° Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¬Ù‡ (receive)**
```json
{
  "type": "receive",
  "title": "ğŸ’° Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¬Ù‡",
  "body": "Ø´Ù…Ø§ 0.001 BTC Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒØ¯",
  "channel": "receive_channel",
  "sound": "receive_sound",
  "priority": "high"
}
```

#### **ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ ÙˆØ¬Ù‡ (send)**
```json
{
  "type": "send", 
  "title": "ğŸ“¤ Ø§Ø±Ø³Ø§Ù„ ÙˆØ¬Ù‡",
  "body": "Ø´Ù…Ø§ 0.001 BTC Ø§Ø±Ø³Ø§Ù„ Ú©Ø±Ø¯ÛŒØ¯",
  "channel": "send_channel",
  "sound": "send_sound",
  "priority": "high"
}
```

### **2ï¸âƒ£ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ùˆ Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§**

#### **ğŸ“ˆ Ù‡Ø´Ø¯Ø§Ø± Ù‚ÛŒÙ…Øª (price_alert)**
```json
{
  "type": "price_alert",
  "title": "ğŸ“ˆ Ù‡Ø´Ø¯Ø§Ø± Ù‚ÛŒÙ…Øª",
  "body": "Ù‚ÛŒÙ…Øª Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† Ø¨Ù‡ $65,000 Ø±Ø³ÛŒØ¯",
  "channel": "price_alert_channel",
  "sound": "price_alert_sound",
  "priority": "high"
}
```

#### **ğŸ‰ Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ (welcome)**
```json
{
  "type": "welcome",
  "title": "ğŸ‰ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯",
  "body": "Ø¨Ù‡ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù„Ú©Ø³ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯",
  "channel": "welcome_channel", 
  "sound": "welcome_sound",
  "priority": "default"
}
```

#### **ğŸ›¡ï¸ Ø§Ù…Ù†ÛŒØªÛŒ (security)**
```json
{
  "type": "security",
  "title": "ğŸ›¡ï¸ Ù‡Ø´Ø¯Ø§Ø± Ø§Ù…Ù†ÛŒØªÛŒ", 
  "body": "ÙˆØ±ÙˆØ¯ Ø§Ø² Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø¬Ø¯ÛŒØ¯ ØªØ´Ø®ÛŒØµ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯",
  "channel": "high_importance_channel",
  "sound": "default",
  "priority": "high"
}
```

---

## ğŸ“¦ Ø³Ø§Ø®ØªØ§Ø± Ù¾ÛŒØ§Ù…

### **ğŸ¯ Ø³Ø§Ø®ØªØ§Ø± Ú©Ù„ÛŒ FCM**
```json
{
  "to": "USER_FCM_TOKEN",
  "notification": {
    "title": "Ø¹Ù†ÙˆØ§Ù† Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†",
    "body": "Ù…Ø­ØªÙˆØ§ÛŒ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†" 
  },
  "data": {
    "type": "Ù†ÙˆØ¹ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†",
    "custom_field1": "Ù…Ù‚Ø¯Ø§Ø± Ø³ÙØ§Ø±Ø´ÛŒ 1",
    "custom_field2": "Ù…Ù‚Ø¯Ø§Ø± Ø³ÙØ§Ø±Ø´ÛŒ 2"
  },
  "android": {
    "notification": {
      "channel_id": "Ø´Ù†Ø§Ø³Ù‡ Ú©Ø§Ù†Ø§Ù„",
      "sound": "Ù†Ø§Ù… ØµØ¯Ø§"
    }
  },
  "apns": {
    "payload": {
      "aps": {
        "sound": "Ù†Ø§Ù… ØµØ¯Ø§.caf"
      }
    }
  }
}
```

### **ğŸ’³ ØªØ±Ø§Ú©Ù†Ø´ Ù…Ø§Ù„ÛŒ (Ø¬Ø¯ÛŒØ¯)**
```json
{
  "data": {
    "type": "receive",           // ÛŒØ§ "send"
    "transaction_id": "tx_123456789",
    "amount": "0.001", 
    "currency": "BTC",
    "from_address": "1A1zP1eP2sh...",
    "to_address": "bc1qxy2k...",
    "wallet_id": "wallet-123",
    "block_height": "780123",
    "confirmations": "3"
  }
}
```

### **ğŸ’³ ØªØ±Ø§Ú©Ù†Ø´ Ù…Ø§Ù„ÛŒ (Ù‚Ø¯ÛŒÙ…ÛŒ - Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø´Ø¯Ù‡)**
```json
{
  "data": {
    "type": "transaction",
    "direction": "inbound",      // ÛŒØ§ "outbound"
    "transaction_id": "tx_123456789",
    "amount": "0.001",
    "symbol": "BTC",            // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² symbol Ø¨Ù‡ Ø¬Ø§ÛŒ currency
    "from_address": "1A1zP1eP2sh...",
    "to_address": "bc1qxy2k..."
  }
}
```

### **ğŸ“Š Ø³Ø§ÛŒØ± Ø§Ù†ÙˆØ§Ø¹**
```json
{
  "data": {
    // Welcome
    "type": "welcome",
    "user_id": "user-123",
    "wallet_count": "1",
    
    // Price Alert  
    "type": "price_alert",
    "symbol": "BTC",
    "current_price": "65000",
    "target_price": "60000",
    "direction": "above",
    
    // Security
    "type": "security", 
    "action": "login",
    "device_info": "Samsung Galaxy S21",
    "location": "Tehran, Iran",
    "ip_address": "192.168.1.1"
  }
}
```

---

## ğŸ”Š Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ Ùˆ ØµØ¯Ø§Ù‡Ø§

### **ğŸ“± Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Android**

| Ù†ÙˆØ¹ | Ú©Ø§Ù†Ø§Ù„ ID | Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„ | Ø§Ù‡Ù…ÛŒØª | ØµØ¯Ø§ |
|-----|----------|-----------|--------|-----|
| Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¬Ù‡ | `receive_channel` | Receive Notifications | HIGH | receive_sound |
| Ø§Ø±Ø³Ø§Ù„ ÙˆØ¬Ù‡ | `send_channel` | Send Notifications | HIGH | send_sound |
| Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ | `welcome_channel` | Welcome Notifications | DEFAULT | welcome_sound |
| Ù‡Ø´Ø¯Ø§Ø± Ù‚ÛŒÙ…Øª | `price_alert_channel` | Price Alert Notifications | HIGH | price_alert_sound |
| Ø¹Ù…ÙˆÙ…ÛŒ | `high_importance_channel` | General Notifications | HIGH | default |

### **ğŸµ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØµÙˆØªÛŒ**

#### **ğŸ“‚ Ù…Ø³ÛŒØ± Android:**
```
android/app/src/main/res/raw/
â”œâ”€â”€ receive_sound.ogg
â”œâ”€â”€ send_sound.ogg  
â”œâ”€â”€ welcome_sound.ogg
â””â”€â”€ price_alert_sound.ogg
```

#### **ğŸ“‚ Ù…Ø³ÛŒØ± iOS:**
```
ios/Runner/Sounds/
â”œâ”€â”€ receive_sound.caf
â”œâ”€â”€ send_sound.caf
â”œâ”€â”€ welcome_sound.caf  
â””â”€â”€ price_alert_sound.caf
```

### **âš™ï¸ Ø³Ø§Ø®Øª Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§**

#### **ğŸ¤– Android (Native):**
```kotlin
private fun createNotificationChannels() {
    val channels = listOf(
        NotificationChannel(
            RECEIVE_CHANNEL_ID,
            "Receive Notifications", 
            NotificationManager.IMPORTANCE_HIGH
        ).apply {
            setSound(
                Uri.parse("android.resource://$packageName/raw/receive_sound"),
                null
            )
        }
        // ... Ø³Ø§ÛŒØ± Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§
    )
    
    channels.forEach { notificationManager.createNotificationChannel(it) }
}
```

#### **ğŸ“± Flutter:**
```dart
static Future<void> _createNotificationChannels() async {
  await android?.createNotificationChannel(
    const AndroidNotificationChannel(
      'receive_channel',
      'Receive Notifications',
      description: 'Channel for receive notifications',
      importance: Importance.high,
      sound: RawResourceAndroidNotificationSound('receive_sound'),
    )
  );
}
```

---

## ğŸ§ª ØªØ³Øª Ùˆ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ

### **1ï¸âƒ£ ØªØ³Øª Ù…Ø­Ù„ÛŒ (Local Testing)**

#### **ğŸ“ Python Script (`test_notifications.py`):**
```python
import requests

def send_fcm_notification(token, notification_type="receive"):
    payload = {
        "to": token,
        "notification": {
            "title": "ØªØ³Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†",
            "body": "Ø§ÛŒÙ† ÛŒÚ© ØªØ³Øª Ø§Ø³Øª"
        },
        "data": {
            "type": notification_type,
            "amount": "0.001",
            "currency": "BTC"
        }
    }
    
    response = requests.post(
        "https://fcm.googleapis.com/fcm/send",
        json=payload,
        headers={
            "Authorization": "key=YOUR_SERVER_KEY",
            "Content-Type": "application/json"
        }
    )
    
    print(f"Response: {response.status_code}")
    print(f"Body: {response.text}")

# Ø§Ø³ØªÙØ§Ø¯Ù‡
send_fcm_notification("YOUR_FCM_TOKEN", "receive")
```

#### **ğŸ”§ cURL Command:**
```bash
curl -X POST https://fcm.googleapis.com/fcm/send \
  -H "Authorization: key=YOUR_SERVER_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "to": "YOUR_FCM_TOKEN",
    "notification": {
      "title": "ØªØ³Øª Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†", 
      "body": "Ø´Ù…Ø§ 0.001 BTC Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒØ¯"
    },
    "data": {
      "type": "receive",
      "amount": "0.001", 
      "currency": "BTC",
      "transaction_id": "test_tx_123"
    }
  }'
```

### **2ï¸âƒ£ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Logs**

#### **ğŸ“± Flutter Console:**
```bash
flutter run --debug -d device_id

# Logs Ø´Ø§Ù…Ù„:
# ğŸ”¥ Firebase initialized successfully
# ğŸª™ FCM Token: [TOKEN] 
# ğŸ“± Message received: [DETAILS]
# âœ… Local notification shown on channel: receive_channel
```

#### **ğŸ¤– Android Logcat:**
```bash
adb logcat | grep "MyFirebaseMessaging"

# Logs Ø´Ø§Ù…Ù„:
# D/MyFirebaseMessaging: ğŸ“± Message received from: [SENDER]
# D/MyFirebaseMessaging: ğŸ“± Message data: {type=receive, amount=0.001}
# D/MyFirebaseMessaging: ğŸ”” Showing notification on channel: receive_channel
```

### **3ï¸âƒ£ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ù…Ø³Ø§Ø¦Ù„ Ø±Ø§ÛŒØ¬**

#### **âŒ FCM Token Ù†Ù…ÛŒâ€ŒØ¢ÛŒØ¯:**
```dart
// Ø¨Ø±Ø±Ø³ÛŒ Firebase initialization
if (Firebase.apps.isEmpty) {
  await Firebase.initializeApp();
}

// Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¬ÙˆØ²Ù‡Ø§
final permission = await Permission.notification.status;
if (!permission.isGranted) {
  await Permission.notification.request();
}
```

#### **âŒ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯:**
```kotlin
// Ø¨Ø±Ø±Ø³ÛŒ Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§
private fun checkNotificationChannels() {
    val channels = notificationManager.notificationChannels
    Log.d(TAG, "Available channels: ${channels.map { it.id }}")
}

// Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø¬ÙˆØ²Ù‡Ø§
private fun checkNotificationPermission(): Boolean {
    return NotificationManagerCompat.from(this).areNotificationsEnabled()
}
```

#### **âŒ ØµØ¯Ø§ Ù¾Ø®Ø´ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯:**
```kotlin
// Ø¨Ø±Ø±Ø³ÛŒ ÙØ§ÛŒÙ„ ØµÙˆØªÛŒ
private fun checkSoundFiles() {
    val soundUri = Uri.parse("android.resource://$packageName/raw/receive_sound")
    Log.d(TAG, "Sound URI: $soundUri")
}
```

### **4ï¸âƒ£ ØªØ³Øª Ø­Ø§Ù„Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ù¾**

#### **âœ… Foreground (Ø§Ù¾ Ø¨Ø§Ø² Ø§Ø³Øª):**
- Flutter `FirebaseMessaging.onMessage` ÙØ¹Ø§Ù„ Ø§Ø³Øª
- Local notification Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Navigation Ù…Ø³ØªÙ‚ÛŒÙ… Ø§Ù…Ú©Ø§Ù†â€ŒÙ¾Ø°ÛŒØ± Ø§Ø³Øª

#### **âœ… Background (Ø§Ù¾ Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡):**
- Native service Ù¾ÛŒØ§Ù… Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- System notification Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯  
- Ø¨Ø§ tap Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø§Ù¾ Ø¨Ø±Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯

#### **âœ… Terminated (Ø§Ù¾ Ø¨Ø³ØªÙ‡):**
- Native service Ù¾ÛŒØ§Ù… Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- System notification Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø¨Ø§ tap Ú©Ø±Ø¯Ù† Ø§Ù¾ Ø¨Ø§Ø² Ù…ÛŒâ€ŒØ´ÙˆØ¯

---

## ğŸŠ Ø®Ù„Ø§ØµÙ‡ Ùˆ Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ

Ø³ÛŒØ³ØªÙ… Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ø§ÛŒÙ† Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† ÛŒÚ© **Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©Ø§Ù…Ù„ Ùˆ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ** Ø§Ø³Øª Ú©Ù‡ Ø´Ø§Ù…Ù„:

### âœ… **ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ:**
- ğŸ”¥ **Firebase Cloud Messaging** Ø¨Ø±Ø§ÛŒ reliability
- ğŸµ **ØµØ¯Ø§Ù‡Ø§ÛŒ Ù…Ø®ØµÙˆØµ** Ø¨Ø±Ø§ÛŒ ØªØ¬Ø±Ø¨Ù‡ Ø¨Ù‡ØªØ± Ú©Ø§Ø±Ø¨Ø±
- ğŸŒ **Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ù‡** Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø¬Ù‡Ø§Ù†ÛŒ
- ğŸ”Š **Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø¬Ø²Ø§** Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ù‡ØªØ±
- ğŸ“± **Native + Flutter** Ø¨Ø±Ø§ÛŒ Ù¾ÙˆØ´Ø´ Ú©Ø§Ù…Ù„ Ø­Ø§Ù„Ø§Øª Ø§Ù¾
- ğŸ›¡ï¸ **Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø¬ÙˆØ²Ù‡Ø§** Ø¨Ø±Ø§ÛŒ Ø§Ù…Ù†ÛŒØª Ùˆ Ù‚ÙˆØ§Ù†ÛŒÙ†

### ğŸ¯ **Ú©Ø§Ø±Ø¨Ø±Ø¯Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**
- ğŸ’° **Ø§Ø¹Ù„Ø§Ù† ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§** (Ø§Ø±Ø³Ø§Ù„/Ø¯Ø±ÛŒØ§ÙØª)
- ğŸ“ˆ **Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ÛŒ Ù‚ÛŒÙ…Øª** Ø¨Ø±Ø§ÛŒ trading
- ğŸ›¡ï¸ **Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ù…Ù†ÛŒØªÛŒ** Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øª
- ğŸ‰ **Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯Ú¯ÙˆÛŒÛŒ** Ø¨Ø±Ø§ÛŒ onboarding

### ğŸš€ **Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ:**
- âš¡ **Ø§Ø¬Ø±Ø§ÛŒ ÙÙˆØ±ÛŒ** Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ±
- ğŸ§ª **ØªØ³Øª Ø¨Ø§ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯** 
- ğŸ”§ **Ø³ÙØ§Ø±Ø´ÛŒâ€ŒØ³Ø§Ø²ÛŒ** Ø³Ø§Ø¯Ù‡
- ğŸ“Š **Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯** Ùˆ Ø¢Ù†Ø§Ù„ÛŒØ²

---

**âœ¨ Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± production Ø§Ø³Øª Ùˆ ØªÙ…Ø§Ù… Ø­Ø§Ù„Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ù…Ú©Ù† Ø±Ø§ Ù¾ÙˆØ´Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯!** 